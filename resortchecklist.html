<!DOCTYPE html>
<html>
<head>
<!--
	Name: Resort Checklist
	Authors: Lee Darcy
	Date: 02/12/2021
	Description: This is an interactive version of our Resort Checklist. This DOES NOT use localStorage to save the data in textboxes and checkboxes.
-->
  <title>Awesome DP Resort Checklist</title>
	<link rel="stylesheet" href="styles.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="magic_script_savable.js"></script>
</head>

<body>
<h1>Resort Checklist</h1>
  <div class="resortinfo">
		Job Name:&nbsp;<textarea class="resort text" id="clientName" name="pt1" rows="1" cols="40"></textarea>&emsp;
		Work Order:&nbsp;<textarea class="resort text" id="workOrderNum" name="pt2" rows="1" cols="6"></textarea>&emsp;
		Date:&nbsp;<textarea class="resort text" id="datedDate" name="pt3" rows="1" cols="8"></textarea>
		<br><br>
    <center>
		<input type='button' onclick='clearBoxes(); ClearText()' value="Reset Checklist">
		</center>
    <br>
  </div>
  <fieldset>
  <legend>Job Attributes</legend>
  <div id="jobfeatures">
  	<ul>
  		<li><input id="SecureCheck" type="checkbox" class="box"><a href="http://watson2/mediawiki/index.php?title=Secure_Jobs" target="_blank">Secure</a></li>
  		<li><input id="ForeignCheck" type="checkbox" class="box"><a href="http://watson2/mediawiki/index.php?title=Foreign_Record_Processing" target="_blank">Foreign</a></li>
  		<li><input id="NCOACheck" type="checkbox" class="box"><a href="http://watson2/mediawiki/index.php?title=NCOA" target="_blank">NCOA</a></li>
  		<li><input id="DeDupeCheck" type="checkbox" class="box"><a href="http://watson2/mediawiki/index.php?title=Duplicate_Removal" target="_blank">De-Dupe</a></li>
  		<li><input id="NDCSCFCheck" type="checkbox" class="box"><a href="http://watson2/mediawiki/index.php?title=NDC/SCF" target="_blank">NDC/SCF</a></li>
  		<li><input id="FCCheck" type="checkbox" class="box" name="specs" value="FC"><a href="http://watson2/mediawiki/index.php?title=First_Class" target="_blank">First Class</a>
  			<ul>
  				<li><input id="RetailCheck" type="checkbox" class="box"><a href="http://watson2/mediawiki/index.php?title=First_Class#Retail_Stamp" target="_blank">Retail Stamp</a></li>
  			</ul>
  		</li>
  		<li><input id="PSLabelsCheck" type="checkbox" class="box"><a href="http://watson2/mediawiki/index.php?title=Pressure_Sensitive_Labels" target="_blank">PS Labels</a></li>
  		<li><input id="WindowEnvCheck" type="checkbox" class="box"><a href="http://watson2/mediawiki/index.php?title=Window_Envelopes" target="_blank">Windowed Envelope</a></li>
  		<br><br>
  		<li><input id="MergeCheck" type="checkbox" class="box" name="specs" value="Merge"><a href="http://watson2/mediawiki/index.php?title=Mail_Merge" target="_blank">Merge</a>
  			<ul>
  				<li><input id="LetterCheck" type="checkbox" class="box">Letter</li>
  				<li><input id="ReplyCheck" type="checkbox" class="box">Reply</li>
  				<li><input id="Env_PCCheck" type="checkbox" class="box">Envelope/PC</li>
  				<li><input id="ClientStockCheck" type="checkbox" class="box">Client Stock</li>
  			</ul>
  		</li>
  		<li><input id="PullCheck" type="checkbox" class="box"><a href="http://watson2/mediawiki/index.php?title=Pulls" target="_blank">Pulls</a></li>
  		<li><input id="DropsElseCheck" type="checkbox" class="box">Drops Elsewhere</li>
  		<li><input id="SublistCheck" type="checkbox" class="box"><a href="http://watson2/mediawiki/index.php?title=Sublists" target="_blank">Sublisted from</a> <textarea rows="1" cols="6"></textarea></li>
  	</ul>
  </div>
  </fieldset>
  <div id="resortchecklist">
    <ul>
      <li class="notenv_pc"><input type="checkbox"><span class="strikeIt">Delete Output to X.</scan></li>
      <li><input type="checkbox">Delete digital/recycle paper:
        <ul>
          <li class="notretail"><input type="checkbox">Qualification Report</li>
          <li class="notretail"><input type="checkbox">Postage Statement</li>
          <li class="notretail"><input type="checkbox">Tray tags</li>
          <li class="notretail"><input type="checkbox">Pallet Tags</li>
          <li class="ndcscf"><input type="checkbox"> NDC/SCF paperwork.</li>
          <li class="pslabels"><input type="checkbox">Pressure-sensitive labels</li>
        </ul>
      <li class="notretail"><input type="checkbox">Email BCC to cancel your Track N Trace job.<br><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reply to the initial email you received from BCC about the job.</i></li>
      <li class="notretail"><input type="checkbox">Delete Track N Trace screenshot.</li>
      <li><input type="checkbox">Make the necessary changes to the records in Mail Manager.</li>
      <li class="foreign"><input type="checkbox">Reorder the list by Country.</li>
      <li><input type="checkbox">Resort the job.
        <ul>
          <li><input type="checkbox" class="box">Correct select for sort <span class="foreign">(Foreign or no Foreign?)</span></li>
          <li><input type="checkbox" class="box">Select Class and Category from work order</li>
          <li><input type="checkbox" class="box">Verify weight is in Midnight</li>
          <li><input type="checkbox" class="box">Verify piece thickness is in Midnight</li>
          <li><input type="checkbox" class="box"><span class="strikeIt">If not #10, verify l and w is in Midnight</span></li>
          <li><input type="checkbox" class="box"><span class="strikeIt">Select appropriate tray options if applicable</span></li>
          <li><input type="checkbox" class="box">Select postage type
            <ul>
              <li><input type="checkbox" class="box"><span class="strikeIt">If permit, use one permit and verify indicia</span></li>
              <li><input type="checkbox" class="box"><span class="strikeIt">If precancelled stamp, select addt'l permit</span></li>
            </ul>
          </li>
        </ul>
        </li>
      <li><input type="checkbox">Save/reprint postal paperwork, tray tags, and pallet tags.</li>
      <li class="ndcscf"><input type="checkbox">Save/reprint NDC/SCF paperwork.</li>
      <li class="ndcscf"><input type="checkbox">Send updated NDC/SCF email to the warehouse.</li>
      <li><input type="checkbox">Reorder client stock from warehouse (if counts are very different or if stock has changed).</li>
      <li class="notretail"><input type="checkbox">Redo Track N Trace.</li>
      <ul>
        <li><input type="checkbox">Recapture Track N Trace screenshot.</li>
      </ul>
      <li class="notretail"><input type="checkbox">Recreate Mail.dat.</li>
      <li><input type="checkbox">Update Midnight totals and reprint the Consolidated <span class="foreign">(and Foreign) </span> Work Order.</li>
      <li class="merge"><input type="checkbox">If a Merge job:
        <ul>
          <li class="env_pc"><input type="checkbox">Re-mark USPS fields.</li>
          <li><input type="checkbox">Re-output all merge CSVs.</li>
          <li><input type="checkbox">Open each InDesign document and go to Database > Reload to relink.</li>
          <li><input type="checkbox">Verify that your first and last records have not changed.</li>
          <li><input type="checkbox">Update example presort numbers on the last page of the Work Order.</li>
        </ul>
      </li>
      <li class="notenv_pc"><input type="checkbox" class="box">Output files to X
        <ul>
            <li><input type="checkbox" class="box">Verify fields match worksheet</li>
            <li><input type="checkbox" class="box">Check the correct number of lines in file</li>
            <li><input type="checkbox" class="box">Check for long fields and inconsistent case</li>
            <li><input type="checkbox" class="box">Check city for spacing and zip for placement</li>
            <li><input type="checkbox" class="box"><span class="strikeIt">Comma b/t city & state?</span></li>
            <li class="foreign"><input type="checkbox" class="box">Check if ordered by country</li>
        </ul>
      </li>
      <li><input type="checkbox">Re-mark IMB fields.</li>
      <li class="pslabels"><input type="checkbox">Reprint any pressure-sensitive labels.</li>
      <li><input type="checkbox">Spot check a few random records.</li>
      <li><input type="checkbox">Reoutput Final Mail File.</li>
    </ul>

	<script>
  //https://stackoverflow.com/questions/51543302/store-multiple-checkbox-inputs-in-local-storage/51543547
	//This script retains the checkboxes on refresh.
	function onClickBox() {
		var arr = $('.box').map(function() {
			return this.checked;
			}).get();
			localStorage.setItem("checked", JSON.stringify(arr));
		}

		$(document).ready(function() {
			var arr = JSON.parse(localStorage.getItem('checked')) || [];
			arr.forEach(function(checked, i) {
				$('.box').eq(i).prop('checked', checked);
			});

			$(".box").click(onClickBox);
		});

	//Code based on http://jsfiddle.net/arunpjohny/4EwQy/
	//This retains the data within the textboxes on refresh.
	if (window.localStorage) {
	    $('.text').keyup(function () {
	        localStorage.setItem(this.name, this.value);
	    }).val(function () {
	        return localStorage.getItem(this.name)
	    })
	}

	function clearBoxes() {
		//from https://stackoverflow.com/questions/12364007/uncheck-all-checkbox-on-pageload-using-javascript; I added localStorage.clear
		//This resets the localStorage and clears the checkboxes.
		localStorage.clear();
		var w = document.getElementsByTagName('input');
		for(var i = 0; i < w.length; i++){
			if(w[i].type=='checkbox'){
				w[i].checked = false;
			}
		}
		location.reload();
	}

	function ClearText() {
		//https://stackoverflow.com/questions/21332488/clear-multiple-textbox-using-javascript-on-button-click
		//This clears the textarea boxes.
		var elements = [] ;
		 elements = document.getElementsByTagName("textarea");

		 for(var i=0; i<elements.length ; i++){
				elements[i].value = "" ;
		 }
	}

	var textbox = document.getElementById('workOrderNum')
		function setTitle () {
  		document.title = textbox.value + " " + "DP Resort Checklist"
			}
		textbox.onkeyup = setTitle
		textbox.onchange = setTitle

	</script>
</body>
</html>
