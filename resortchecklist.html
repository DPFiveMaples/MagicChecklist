<!DOCTYPE html>
<html>
<head>
<!--
	Name: Resort Checklist
	Authors: Lee Darcy
	Date: 02/12/2021
	Description: This is an interactive version of our Resort Checklist.
-->
  <title>Awesome DP Resort Checklist</title>
	<link rel="stylesheet" href="styles.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="resort_script_savable.js"></script>
</head>

<body>
<h1>Resort Checklist</h1>
  <div class="jobinforesort">
		Job Name:&nbsp;<textarea class="textresort" id="clientNameResort" name="pt1Resort" rows="1" cols="40"></textarea>&emsp;
		Work Order:&nbsp;<textarea class="textresort" id="workOrderNumResort" name="pt2Resort" rows="1" cols="6"></textarea>&emsp;
		Date:&nbsp;<textarea class="textresort" id="datedDateResort" name="pt3Resort" rows="1" cols="8"></textarea>
		<br><br>
    <center>
		<input type='button' onclick='clearBoxes(); ClearText()' value="Reset Checklist">
		</center>
    <br>
  </div>
  <fieldset>
  <legend>Job Attributes</legend>
  <div id="jobfeatures">
  	<ul>
  		<li><input id="SecureCheckResort" type="checkbox" class="boxResort"><a href="http://watson2/mediawiki/index.php?title=Secure_Jobs" target="_blank">Secure</a></li>
  		<li><input id="ForeignCheckResort" type="checkbox" class="boxResort"><a href="http://watson2/mediawiki/index.php?title=Foreign_Record_Processing" target="_blank">Foreign</a></li>
  		<li><input id="NCOACheckResort" type="checkbox" class="boxResort"><a href="http://watson2/mediawiki/index.php?title=NCOA" target="_blank">NCOA</a></li>
  		<li><input id="DeDupeCheckResort" type="checkbox" class="boxResort"><a href="http://watson2/mediawiki/index.php?title=Duplicate_Removal" target="_blank">De-Dupe</a></li>
  		<li><input id="NDCSCFCheckResort" type="checkbox" class="boxResort"><a href="http://watson2/mediawiki/index.php?title=NDC/SCF" target="_blank">NDC/SCF</a></li>
  		<li><input id="FCCheckResort" type="checkbox" class="boxResort" name="specs" value="FC"><a href="http://watson2/mediawiki/index.php?title=First_Class" target="_blank">First Class</a>
  			<ul>
  				<li><input id="RetailCheckResort" type="checkbox" class="boxResort"><a href="http://watson2/mediawiki/index.php?title=First_Class#Retail_Stamp" target="_blank">Retail Stamp</a></li>
  			</ul>
  		</li>
  		<li><input id="PSLabelsCheckResort" type="checkbox" class="boxResort"><a href="http://watson2/mediawiki/index.php?title=Pressure_Sensitive_Labels" target="_blank">PS Labels</a></li>
  		<li><input id="WindowEnvCheckResort" type="checkbox" class="boxResort"><a href="http://watson2/mediawiki/index.php?title=Window_Envelopes" target="_blank">Windowed Envelope</a></li>
  		<li><input id="MergeCheckResort" type="checkbox" class="boxResort" name="specs" value="Merge"><a href="http://watson2/mediawiki/index.php?title=Mail_Merge" target="_blank">Merge</a>
  			<ul>
  				<li><input id="LetterCheckResort" type="checkbox" class="boxResort">Letter</li>
  				<li><input id="ReplyCheckResort" type="checkbox" class="boxResort">Reply</li>
  				<li><input id="Env_PCCheckResort" type="checkbox" class="boxResort">Envelope/PC</li>
  				<li><input id="ClientStockCheckResort" type="checkbox" class="boxResort">Client Stock</li>
  			</ul>
  		</li>
  	</ul>
  </div>
  </fieldset>
  <div id="checklist">
    <ul>
      <li class="notenv_pc"><input type="checkbox"><span class="strikeItResort">Delete Output to X.</scan></li>
      <li><input type="checkbox">Delete digital/recycle paper:
        <ul>
          <li class="notretail"><input type="checkbox">Qualification Report</li>
          <li class="notretail"><input type="checkbox">Postage Statement</li>
          <li class="notretail"><input type="checkbox">Tray tags</li>
          <li class="notretail"><input type="checkbox">Pallet Tags</li>
          <li class="ndcscf"><input type="checkbox"> 2 NDC/SCF Destination Summary Reports</li>
          <li class="pslabels"><input type="checkbox">Pressure-sensitive labels</li>
        </ul>
      <li class="notretail"><input type="checkbox">Email BCC to cancel your Track N Trace job.<br><i>Reply to the initial email you received from BCC about the job.</i></li>
      <li class="notretail"><input type="checkbox">Delete Track N Trace screenshot.</li>
      <li><input type="checkbox">Make the necessary changes to the records in Mail Manager.</li>
      <li class="foreign"><input type="checkbox">Reorder the list by Country.</li>
      <li><input type="checkbox">Resort the job.
        <ul>
          <li><input type="checkbox" class="boxResort">Correct select for sort <span class="foreign">(Foreign or no Foreign?)</span></li>
          <li><input type="checkbox" class="boxResort">Select Class and Category from work order</li>
          <li><input type="checkbox" class="boxResort">Verify weight is in Midnight</li>
          <li><input type="checkbox" class="boxResort">Verify piece thickness is in Midnight</li>
          <li><input type="checkbox" class="boxResort"><span class="strikeItResort">If not #10, verify l and w is in Midnight</span></li>
          <li><input type="checkbox" class="boxResort"><span class="strikeItResort">Select appropriate tray options if applicable</span></li>
          <li><input type="checkbox" class="boxResort">Select postage type
            <ul>
              <li><input type="checkbox" class="boxResort"><span class="strikeItResort">If permit, use one permit and verify indicia</span></li>
              <li><input type="checkbox" class="boxResort"><span class="strikeItResort">If precancelled stamp, select addt'l permit</span></li>
            </ul>
          </li>
        </ul>
        </li>
        <li class="ndcscf"><input type="checkbox">Re-save Destination Summary Report (all available NDC/SCF locations)</li>
        <li class="notretail"><input type="checkbox" class="boxResort">Verify record count in sort matches work order</li>
      	<li class="notretail"><input type="checkbox" class="boxResort">Click the Save & Exit Icon to save the sort; reopen</li>
      	<li class="notretail"><input type="checkbox" class="boxResort">Save qualification report
      		<ul>
      			<li><input type="checkbox" class="boxResort">Review printout for accuracy (thickness, weight and class/category of mail<span class="ndcscf">, 2nd Destination Summary Report</span>)</li>
      		</ul>
      	</li>
      	<li class="notretail"><input type="checkbox" class="boxResort">Re-save 3602 (Postage Statement) report
      		<ul>
      			<li><input type="checkbox" class="boxResort">Enter move update method</li>
      			<li><input type="checkbox" class="boxResort">Review printout for accuracy (class, cat, # of pieces, postage type, permit, crid, mu method)</li>
      		</ul>
      	</li>
      	<li class="notretail"><input type="checkbox" class="boxResort">Reprint container tags
      		<ul>
      			<li class="dropselse"><input type="checkbox" class="boxResort">Change tag location to where it will be dropping</li>
      			<li><input type="checkbox" class="boxResort">Verify printer is clear</li>
      			<li><input type="checkbox" class="boxResort">Select IM Tray</li>
      		</ul>
      	</li>
      	<li class="notretail"><input type="checkbox" class="boxResort">Save pallet placards</li>
      <li class="ndcscf"><input type="checkbox">Send updated NDC/SCF email to the warehouse.</li>
      <li class="clientstock"><input type="checkbox">Reorder client stock from warehouse (if counts are very different or if stock has changed).</li>
      <li class="notretail"><input type="checkbox">Redo Track N Trace.</li>
      <ul>
        <li><input type="checkbox">Recapture Track N Trace screenshot.</li>
      </ul>
      <li class="notretail notndcscf"><input type="checkbox">Recreate Mail.dat.</li>
      <li><input type="checkbox">Update Midnight totals and reprint the Consolidated <span class="foreign">(and Foreign) </span> Work Order.</li>
      <li class="merge"><input type="checkbox">If a Merge job:
        <ul>
          <li class="env_pc"><input type="checkbox">Re-mark USPS fields.</li>
          <li><input type="checkbox">Re-output all merge CSVs.</li>
          <li><input type="checkbox">Open each InDesign document and go to Database > Reload to relink.</li>
          <li><input type="checkbox">Verify that your first and last records have not changed.</li>
          <li><input type="checkbox">Update example presort numbers on the last page of the Work Order.</li>
        </ul>
      </li>
      <li class="notenv_pc"><input type="checkbox" class="boxResort">Output files to X
        <ul>
            <li><input type="checkbox" class="boxResort">Verify fields match worksheet</li>
            <li><input type="checkbox" class="boxResort">Check the correct number of lines in file</li>
            <li><input type="checkbox" class="boxResort">Check for long fields and inconsistent case</li>
            <li><input type="checkbox" class="boxResort">Check city for spacing and zip for placement</li>
            <li><input type="checkbox" class="boxResort"><span class="strikeItResort">Comma b/t city & state?</span></li>
            <li class="foreign"><input type="checkbox" class="boxResort">Check if ordered by country</li>
        </ul>
      </li>
      <li><input type="checkbox">Re-mark IMB fields.</li>
      <li class="pslabels"><input type="checkbox">Reprint any pressure-sensitive labels.</li>
      <li><input type="checkbox">Spot check a few random records.</li>
      <li><input type="checkbox">Reoutput Final Mail File.</li>
    </ul>

	<script>

  //This script alters the HTML title to contain the Work Order Number by default when saving.
  var textbox = document.getElementById('workOrderNumResort')
		function setTitle () {
      localStorage.setItem("newTitleResort", document.title = textbox.value + " " + "Resort Checklist");
    }
		textbox.onkeyup = setTitle
		textbox.onchange = setTitle

    var readTitle = document.title
    if (localStorage.getItem("newTitleResort") !== null) {
      document.title = localStorage.getItem("newTitleResort");
    }

    //https://stackoverflow.com/questions/51543302/store-multiple-checkbox-inputs-in-local-storage/51543547
  	//This script retains the checkboxes on refresh.

    function onClickBoxResort () {
      var arrResort = $('.boxResort').map(function() {
        return this.checked;
      }).get();
      localStorage.setItem("checkedResort", JSON.stringify(arrResort));
    }

    $(document).ready(function() {
    var arrResort = JSON.parse(localStorage.getItem('checkedResort'))  || [];
    arrResort.forEach(function(checked, i) {
      $('.boxResort').eq(i).prop('checkedResort', checked);
    });
    $('.boxResort').click(OnClickBoxResort);
  });
  	/*function onClickBoxResort() {
  		var arrResort = $('.boxResort').map(function() {
  			return this.checked;
  			}).get();
  			localStorage.setItem("checkedResort", JSON.stringify(arrResort));
  		}

  		$(document).ready(function() {
  			var arrResort = JSON.parse(localStorage.getItem('checkedResort')) || [];
  			arrResort.forEach(function(checked, i) {
  				$('.boxResort').eq(i).prop('checkedResort', checked);
  			});

  			$(".boxResort").click(onClickBoxResort);
  		});*/

	//Code based on http://jsfiddle.net/arunpjohny/4EwQy/
	//This retains the data within the textboxes on refresh.
	if (window.localStorage) {
	    $('.textresort').keyup(function () {
	        localStorage.setItem(this.name, this.value);
	    }).val(function () {
	        return localStorage.getItem(this.name)
	    })
	}

	function clearBoxes() {
		//from https://stackoverflow.com/questions/12364007/uncheck-all-checkbox-on-pageload-using-javascript; I added localStorage.clear
		//This resets the localStorage and clears the checkboxes.
		localStorage.clear();
		var w = document.getElementsByTagName('input');
		for(var i = 0; i < w.length; i++){
			if(w[i].type=='checkbox'){
				w[i].checked = false;
			}
		}
		location.reload();
	}

	function ClearText() {
		//https://stackoverflow.com/questions/21332488/clear-multiple-textbox-using-javascript-on-button-click
		//This clears the textarea boxes.
		var elements = [] ;
		 elements = document.getElementsByTagName("textarea");

		 for(var i=0; i<elements.length ; i++){
				elements[i].value = "" ;
		 }
	}

	</script>
</body>
</html>
